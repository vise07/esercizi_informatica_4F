import utility.Tools;
import veicolo.Veicolo;
import veicolo.Automobile;
import veicolo.Moto;
import java.util.Scanner;

public class Main {
    public static void main(String[] args) {
        Scanner sc = new Scanner(System.in);
        Concessionaria concessionaria = new Concessionaria("Concessionaria XYZ");

        String[] opzioni = {"MENU", "VISUALIZZA", "INSERISCI", "RIMUOVI", "AGGIORNA", "FINE"};
        boolean uscita = false;

        try {
            do {
                switch (Tools.Menu(opzioni, sc)) {
                    case 1 -> {
                        System.out.println("Visualizza veicoli:");
                        concessionaria.stampaConcessionaria(); // Mostra tutti i veicoli
                    }
                    case 2 -> {
                        System.out.println("Inserimento veicolo:");
                        // Chiediamo all'utente il tipo di veicolo da inserire
                        System.out.print("Scegli il tipo di veicolo (1- Automobile, 2- Moto): ");
                        int tipoVeicolo = Integer.parseInt(sc.nextLine());

                        System.out.print("Inserisci la marca: ");
                        String marca = sc.nextLine();
                        System.out.print("Inserisci il modello: ");
                        String modello = sc.nextLine();
                        System.out.print("Inserisci il prezzo: ");
                        int prezzo = Integer.parseInt(sc.nextLine());

                        Veicolo veicolo;
                        if (tipoVeicolo == 1) {
                            System.out.print("Inserisci il numero di porte: ");
                            int numeroPorte = Integer.parseInt(sc.nextLine());
                            veicolo = new Automobile(marca, modello, prezzo, numeroPorte);
                        } else if (tipoVeicolo == 2) {
                            System.out.print("Inserisci la cilindrata: ");
                            int cilindrata = Integer.parseInt(sc.nextLine());
                            veicolo = new Moto(marca, modello, prezzo, cilindrata);
                        } else {
                            System.out.println("Opzione non valida.");
                            continue;
                        }

                        try {
                            concessionaria.addVeicolo(veicolo);
                            System.out.println("Veicolo inserito correttamente.");
                        } catch (Exception e) {
                            System.out.println("Errore nell'inserimento: " + e.getMessage());
                        }
                    }
                    case 3 -> {
                        System.out.println("Eliminazione veicolo:");
                        System.out.print("Inserisci la marca del veicolo da rimuovere: ");
                        String marcaRimuovere = sc.nextLine();
                        System.out.print("Inserisci il modello del veicolo da rimuovere: ");
                        String modelloRimuovere = sc.nextLine();

                        Veicolo veicoloDaRimuovere = null;
                        for (Veicolo v : concessionaria.getConcessionaria()) {
                            if (v.getMarca().equals(marcaRimuovere) && v.getModello().equals(modelloRimuovere)) {
                                veicoloDaRimuovere = v;
                                break;
                            }
                        }

                        if (veicoloDaRimuovere != null) {
                            try {
                                concessionaria.removeVeicolo(veicoloDaRimuovere);
                                System.out.println("Veicolo rimosso.");
                            } catch (Exception e) {
                                System.out.println("Errore nell'eliminazione: " + e.getMessage());
                            }
                        } else {
                            System.out.println("Veicolo non trovato.");
                        }
                    }
                    case 4 -> {
                        System.out.println("Aggiornamento veicolo:");
                        System.out.print("Inserisci la marca del veicolo da aggiornare: ");
                        String marcaAggiornare = sc.nextLine();
                        System.out.print("Inserisci il modello del veicolo da aggiornare: ");
                        String modelloAggiornare = sc.nextLine();

                        Veicolo veicoloDaAggiornare = null;
                        for (Veicolo v : concessionaria.getConcessionaria()) {
                            if (v.getMarca().equals(marcaAggiornare) && v.getModello().equals(modelloAggiornare)) {
                                veicoloDaAggiornare = v;
                                break;
                            }
                        }

                        if (veicoloDaAggiornare != null) {
                            System.out.println("Veicolo trovato: " + veicoloDaAggiornare);
                            System.out.println("Cosa desideri aggiornare?");
                            System.out.println("1 - Modello");
                            System.out.println("2 - Prezzo");
                            int sceltaAggiornamento = Integer.parseInt(sc.nextLine());

                            if (sceltaAggiornamento == 1) {
                                System.out.print("Inserisci il nuovo modello: ");
                                String nuovoModello = sc.nextLine();
                                veicoloDaAggiornare.setModello(nuovoModello);
                                System.out.println("Modello aggiornato.");
                            } else if (sceltaAggiornamento == 2) {
                                System.out.print("Inserisci il nuovo prezzo: ");
                                int nuovoPrezzo = Integer.parseInt(sc.nextLine());
                                veicoloDaAggiornare.setPrezzo(nuovoPrezzo);
                                System.out.println("Prezzo aggiornato.");
                            } else {
                                System.out.println("Opzione non valida.");
                            }
                        } else {
                            System.out.println("Veicolo non trovato.");
                        }
                    }
                    case 5 -> uscita = true;
                }

            } while (!uscita);

        } catch (Exception e) {
            System.out.println("Errore.");
            System.out.println(e.getMessage());
        }

        System.out.println("Fine programma.");
    }
}
