import static utility.Tools.*;

import java.time.LocalDate;
import java.time.format.DateTimeFormatter;
import java.util.ArrayList;
import java.util.Scanner;


public class Main {
    public static void main(String[] args) {
        Scanner sc = new Scanner(System.in);

        final int MAXAUTOMOBILI = 5;
        ArrayList<Automobile> Concessionaria = new ArrayList<>(MAXAUTOMOBILI);
        int contaAuto = 0;
        boolean uscita = true;

        String[] opzioni = {"MENU", "INSERIMENTO", "ELIMINAZIONE X MARCA E MODELLO", "VISUALIZZA", "FINE"};

        do {

            switch (Menu(opzioni, sc)) {
                case 1 -> {

                    if(contaAuto < MAXAUTOMOBILI) {

                        int test;

                        Automobile newAuto = inserimentoAutomobile(sc);

                        test = controlloDoppioni(Concessionaria, contaAuto, newAuto);

                        if(test == -1) {

                            Concessionaria.add(newAuto);
                            contaAuto++;

                        } else {
                            System.out.println("L'auto che vuoi inserire è già presente nella concessionaria.");
                        }


                    } else {
                        System.out.println("La concessionaria è piena, non si posso aggiungere nuove auto.");
                    }

                }

                case 3 -> {

                    if(contaAuto > 0) {

                        System.out.println("Il numero di auto che ci sono nella concessionaria è " + contaAuto + " e sono:");
                        Concessionaria.forEach(a -> System.out.println(a.toString()));

                    } else {
                        System.out.println("La concessionaria è vuota, non ci sono auto da visualizzare.");
                    }


                }
                case 4 -> {
                    uscita = false;
                }
            }

        } while(uscita);

        System.out.println("Fine programma.");
    }


    //metodo per inserire un auto nuova
    public static Automobile inserimentoAutomobile(Scanner sc) {

        Automobile auto = new Automobile();

        System.out.println("Inserisci la marca dell'auto:");
        auto.marca = sc.nextLine();

        System.out.println("Inserisci il modello dell'auto:");
        auto.modello = sc.nextLine();

        System.out.println("Inserisci la data di produzione dell'auto in gg-mm-aaaa:");
        auto.dataDiProduzione = LocalDate.parse(sc.nextLine(), DateTimeFormatter.ofPattern("dd-MM-yyyy"));

        System.out.println("Inserisci la cilindrata dell'auto:");
        auto.cilindrata = Integer.parseInt(sc.nextLine());

        return auto;
    }


    //metodo per controllare se l'auto che si vuole inserire sia già stata inserita o no
    public static int controlloDoppioni(ArrayList<Automobile> concessionara, int contaAuto, Automobile newAuto) {

        for (int i = 0; i < contaAuto; i++) {

            if (concessionara.get(i).marca.equalsIgnoreCase(newAuto.marca) && concessionara.get(i).modello.equalsIgnoreCase(newAuto.modello)) {
                return i;
            }

        }

        return -1;
    }
}
